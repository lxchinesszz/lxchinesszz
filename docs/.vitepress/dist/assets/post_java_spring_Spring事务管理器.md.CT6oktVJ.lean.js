import{_ as i,o as n,c as a,a4 as e}from"./chunks/framework.B8fosacB.js";const d=JSON.parse('{"title":"Springäº‹åŠ¡ç®¡ç†å™¨Hooks","description":"","frontmatter":{"breadcrumb":false,"navbar":true,"sidebar":true,"pageInfo":true,"contributor":true,"editLink":true,"updateTime":true,"prev":true,"next":true,"comment":true,"footer":true,"backtotop":true,"title":"Springäº‹åŠ¡ç®¡ç†å™¨Hooks","category":"Spring"},"headers":[],"relativePath":"post/java/spring/Springäº‹åŠ¡ç®¡ç†å™¨.md","filePath":"post/java/spring/Springäº‹åŠ¡ç®¡ç†å™¨.md","lastUpdated":1731158524000}'),l={name:"post/java/spring/Springäº‹åŠ¡ç®¡ç†å™¨.md"};function t(p,s,r,h,o,c){return n(),a("div",{"data-pagefind-body":!0},s[0]||(s[0]=[e(`<p><img src="https://img.springlearn.cn/blog/learn_1647108921000.png" alt=""></p><p><strong>ä½œè€…: å…«é˜¿å“¥çš„å‰‘</strong></p><p><em>åšå®¢: <a href="https://springlearn.cn" target="_blank" rel="noreferrer">https://springlearn.cn</a></em></p><div class="tip custom-block"><p class="custom-block-title">ä¸€æ—¥ä¸€å¥æ¯’é¸¡æ±¤</p><p>é—®ä¸–é—´é’±ä¸ºä½•ç‰©ï¼Œåªå«äººç”Ÿæ­»ç›¸è®¸ã€‚ï¼ğŸ˜„</p></div><p>å†™æ–‡ç« ä¸å®¹æ˜“ï¼Œå¦‚æœæ„Ÿè§‰è¿˜è¡Œï¼Œè¯·ç‚¹ä¸ªå…³æ³¨ï¼Œç‚¹å…³æ³¨ä¸è¿·è·¯ã€‚</p><h2 id="transactionsynchronizationmanager" tabindex="-1">TransactionSynchronizationManager <a class="header-anchor" href="#transactionsynchronizationmanager" aria-label="Permalink to &quot;TransactionSynchronizationManager&quot;">â€‹</a></h2><p><code>TransactionSynchronizationManager</code> æ˜¯ Spring æ¡†æ¶ä¸­çš„ä¸€ä¸ªå·¥å…·ç±»ï¼Œå®ƒä¸»è¦ç”¨äºç®¡ç†äº‹åŠ¡åŒæ­¥çš„ç›¸å…³å†…å®¹ã€‚åœ¨ Spring ä¸­ï¼Œäº‹åŠ¡ç®¡ç†æ˜¯é€šè¿‡å£°æ˜å¼äº‹åŠ¡æˆ–è€…ç¼–ç¨‹å¼äº‹åŠ¡å®ç°çš„ï¼Œè€Œ <code>TransactionSynchronizationManager</code> åˆ™æ˜¯ Spring ç®¡ç†äº‹åŠ¡åŒæ­¥æ—¶çš„æ ¸å¿ƒç»„ä»¶ä¹‹ä¸€ã€‚</p><p>å®ƒçš„ä¸»è¦åŠŸèƒ½åŒ…æ‹¬ï¼š</p><ol><li><p><strong>ç»‘å®šèµ„æº</strong>ï¼š<code>TransactionSynchronizationManager</code> å…è®¸å°†èµ„æºï¼ˆå¦‚æ•°æ®åº“è¿æ¥ã€ä¼šè¯ç­‰ï¼‰ç»‘å®šåˆ°å½“å‰çº¿ç¨‹ï¼Œä½¿å¾—åœ¨äº‹åŠ¡è¿‡ç¨‹ä¸­ï¼Œè¿™äº›èµ„æºå¯ä»¥åœ¨ä¸åŒçš„è°ƒç”¨æ–¹ä¹‹é—´å…±äº«ã€‚</p></li><li><p><strong>äº‹åŠ¡åŒæ­¥</strong>ï¼šå®ƒç®¡ç†äº‹åŠ¡çš„åŒæ­¥å›è°ƒï¼Œåœ¨äº‹åŠ¡çš„ä¸åŒé˜¶æ®µï¼ˆå¦‚æäº¤å‰ã€æäº¤åã€å›æ»šæ—¶ç­‰ï¼‰æ‰§è¡Œæ³¨å†Œçš„å›è°ƒæ“ä½œã€‚è¿™ä½¿å¾—ä½ å¯ä»¥åœ¨äº‹åŠ¡çš„ä¸åŒçŠ¶æ€æ—¶æ‰§è¡Œä¸€äº›è‡ªå®šä¹‰çš„æ“ä½œã€‚</p></li><li><p><strong>äº‹åŠ¡çŠ¶æ€ç®¡ç†</strong>ï¼šå¯ä»¥æ£€æŸ¥å½“å‰çº¿ç¨‹æ˜¯å¦æœ‰ç»‘å®šçš„äº‹åŠ¡ï¼Œæˆ–è€…å½“å‰äº‹åŠ¡æ˜¯å¦åªè¯»ï¼Œäº‹åŠ¡çš„éš”ç¦»çº§åˆ«ç­‰ã€‚</p></li><li><p><strong>äº‹åŠ¡æŒ‚èµ·å’Œæ¢å¤</strong>ï¼šå½“åµŒå¥—äº‹åŠ¡æˆ–ä¼ æ’­è¡Œä¸ºä¸ºâ€œæš‚åœå½“å‰äº‹åŠ¡â€æ—¶ï¼Œå®ƒå¯ä»¥æŒ‚èµ·å½“å‰äº‹åŠ¡çš„èµ„æºå¹¶åœ¨éœ€è¦æ—¶æ¢å¤å®ƒä»¬ã€‚</p></li></ol><p>å¸¸ç”¨çš„æ–¹æ³•åŒ…æ‹¬ï¼š</p><ul><li><code>isSynchronizationActive()</code>ï¼šæ£€æŸ¥å½“å‰çº¿ç¨‹æ˜¯å¦æœ‰æ´»åŠ¨çš„äº‹åŠ¡åŒæ­¥ã€‚</li><li><code>registerSynchronization(TransactionSynchronization synchronization)</code>ï¼šåœ¨å½“å‰äº‹åŠ¡ä¸Šæ³¨å†ŒåŒæ­¥å›è°ƒã€‚</li><li><code>getResource(Object key)</code>ï¼šä»å½“å‰çº¿ç¨‹è·å–ä¸æŒ‡å®š key ç»‘å®šçš„èµ„æºã€‚</li><li><code>bindResource(Object key, Object value)</code>ï¼šç»‘å®šèµ„æºåˆ°å½“å‰çº¿ç¨‹ã€‚</li><li><code>unbindResource(Object key)</code>ï¼šè§£é™¤èµ„æºçš„ç»‘å®šã€‚</li></ul><p>è¿™åœ¨åŸºäº Spring çš„äº‹åŠ¡ç®¡ç†ä¸­éå¸¸å…³é”®ï¼Œå› ä¸º Spring é€šè¿‡è¿™äº›æœºåˆ¶å®ç°äº†é«˜åº¦çš„äº‹åŠ¡ç®¡ç†æŠ½è±¡ï¼Œä½¿å¼€å‘è€…èƒ½æ›´ç®€å•åœ°å¤„ç†äº‹åŠ¡ã€‚</p><h2 id="ä½¿ç”¨åœºæ™¯" tabindex="-1">ä½¿ç”¨åœºæ™¯ <a class="header-anchor" href="#ä½¿ç”¨åœºæ™¯" aria-label="Permalink to &quot;ä½¿ç”¨åœºæ™¯&quot;">â€‹</a></h2><h3 id="äº‹åŠ¡æäº¤åhooks" tabindex="-1">äº‹åŠ¡æäº¤åhooks <a class="header-anchor" href="#äº‹åŠ¡æäº¤åhooks" aria-label="Permalink to &quot;äº‹åŠ¡æäº¤åhooks&quot;">â€‹</a></h3><ul><li>afterCommit() <ul><li>æ­¤æ–¹æ³•ä¼šåœ¨äº‹åŠ¡æˆåŠŸæäº¤ä¹‹åè°ƒç”¨ï¼Œé€‚åˆè¿›è¡Œä¸€äº›ä¾èµ–äºäº‹åŠ¡æˆåŠŸçš„åç»­æ“ä½œã€‚æ¯”å¦‚åœ¨äº‹åŠ¡æˆåŠŸæäº¤åï¼Œå‘é€ç¡®è®¤æ¶ˆæ¯æˆ–è€…é‚®ä»¶é€šçŸ¥ã€‚</li><li>æ³¨æ„: <ul><li>å¦‚æœæ–¹æ³•ä¸­æŠ›å‡º RuntimeExceptionï¼Œå¼‚å¸¸ä¼šè¢«ä¼ æ’­ç»™è°ƒç”¨è€…ï¼ˆæ³¨æ„ï¼Œä¸è¦åœ¨è¿™é‡ŒæŠ›å‡º TransactionException çš„å­ç±»ï¼‰ã€‚</li><li>äº‹åŠ¡å·²ç»æäº¤ï¼Œä½†äº‹åŠ¡èµ„æºå¯èƒ½ä»ç„¶æ´»è·ƒä¸”å¯è®¿é—®ã€‚è¿™æ„å‘³ç€æ­¤æ—¶æ‰§è¡Œçš„æ•°æ®è®¿é—®æ“ä½œä»ç„¶ä¼šå‚ä¸åŸå§‹äº‹åŠ¡ã€‚</li></ul></li></ul></li></ul><div class="language-java vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    /**</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">     * äº‹åŠ¡ä»£ç å—,ä»£ç å—é‡Œé¢çš„æ“ä½œä¼šæ”¾åœ¨ä¸€ä¸ªå•ç‹¬çš„äº‹åŠ¡ä¸­</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">     */</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    @</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">FunctionalInterface</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    public</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> interface</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> TransactionCodeBlock</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        /**</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">         * äº‹åŠ¡åŠ¨ä½œ</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">         */</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        void</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> transactionAction</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">   public</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> static</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> void</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> afterCommit</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(TransactionCodeBlock codeBlock) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        TransactionSynchronizationManager.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">registerSynchronization</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> TransactionSynchronization</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            @</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">Override</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">            public</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> void</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> afterCommit</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                codeBlock.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">transactionAction</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><ul><li>afterCompletion(int status) <ul><li>æ­¤æ–¹æ³•åœ¨äº‹åŠ¡å®Œæˆåè°ƒç”¨ï¼Œæ— è®ºäº‹åŠ¡æ˜¯æäº¤è¿˜æ˜¯å›æ»šã€‚é€šå¸¸ç”¨äºæ¸…ç†èµ„æºï¼Œä¾‹å¦‚å…³é—­è¿æ¥æˆ–é‡Šæ”¾é”ç­‰æ“ä½œã€‚</li><li>æ³¨æ„åŒä¸Š</li></ul></li></ul>`,17)]))}const g=i(l,[["render",t]]);export{d as __pageData,g as default};
